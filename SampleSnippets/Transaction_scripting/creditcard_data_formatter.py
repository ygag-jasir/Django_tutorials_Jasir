import sys


transaction_list = [


    ["10/11/2022", "6817472515", "BISMI HYPERMART MALAPPURAM IN", "189", "946.27", "DB"],
    ["10/11/2022", "6822254396", "JUST LOAF MALAPPURAM IN", "8", "420.00", "DB"],
    ["10/11/2022", "6822668565", "BEAUTY SILKS MALAPPURAM IN", "44", "2248.00", "DB"],
    ["11/11/2022", "6819357754", "Joining Fee", "0", "500.00", "DB"],
    ["11/11/2022", "6819357758", "IGST-CI@18%", "0", "90.00", "DB"],
    ["15/11/2022", "6837197707",
        "REL RETAIL LTD-SMART MALAPPURAM IN", "654", "3272.63", "DB"],
    ["21/11/2022", "6855265230",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "7476.90", "CR"],
    ["21/11/2022", "6860487296", "REL RETAIL LTD-SMART MALAPPURAM IN", "8", "40.00", "DB"],
    ["21/11/2022", "6860538330", "AMAZON WEB SERVICES MUMBAI IN", "0", "7.42", "DB"],
    ["22/11/2022", "6863418988",
        "REL RETAIL LTD-SMART MALAPPURAM IN", "125", "626.68", "DB"],
    ["01/12/2022", "6892927565",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "1536.27", "CR"],
    ["19/01/2023", "7087096601", "GITHUB HTTPSGITHUB.C US* 16 10", "USD", "852.12", "DB"],
    ["21/01/2023", "7092207148",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "852.12", "CR"],
    ["22/01/2023", "7101564458", "GULF OWN MOBILES MALAPURAM IN",
        "17500", "-87500.00", "DB"],
    ["24/01/2023", "7103666673", "GULF OWN MOBILES MALAPURAM IN",
        "-17500", "87500.00", "CR"],
    ["24/01/2023", "7103824006", "INSTANT EMI OFFUS CONVERSION", "0", "0.00", "CR"],
    ["24/01/2023", "7103824008", "Processing Fee 199 : 0%", "0", "199.00", "DB"],
    ["24/01/2023", "7103824011", "IGST-CI@18%", "0", "35.82", "DB"],
    ["24/01/2023", "7103824017",
        "Interest Amount Amortization - <1/12>", "0", "1165.94", "DB"],
    ["24/01/2023", "7103824020", "IGST-CI@18%", "0", "209.87", "DB"],
    ["24/01/2023", "7103824025",
        "Principal Amount Amortization - <1/12>", "0", "6772.60", "DB"],
    ["28/01/2023", "7117578720",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8383.23", "CR"],
    ["02/02/2023", "7140435461", "BUDGET FOODS PVT LTD KOZHIKODE IN", "14", "74.00", "DB"],
    ["09/02/2023", "7163745015",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "74.00", "CR"],

    ["19/12/2022", "6971692121",
        "Flipkart Internet Pvt Ltd BANGALORE IN", "59", "2990.00", "DB"],
    ["04/01/2023", "7024652258",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "2127.83", "CR"],
    ["12/02/2023", "7179102500",
        "BUDGET FOODS PVT LTD KOZHIKODE IN", "319", "1599.00", "DB"],
    ["12/02/2023", "7179102568", "BUDGET FOODS PVT LTD KOZHIKODE IN",
        "1339", "6695.76", "DB"],
    ["17/02/2023", "7197322624",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8294.76", "CR"],
    ["24/02/2023", "7223300782",
        "Interest Amount Amortization - <2/12>", "0", "1075.69", "DB"],
    ["24/02/2023", "7223300787", "IGST-CI@18%", "0", "193.62", "DB"],
    ["24/02/2023", "7223300798",
        "Principal Amount Amortization - <2/12>", "0", "6862.85", "DB"],
    ["03/03/2023", "7252608940",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8132.16", "CR"],

    ["18/03/2023", "7316317744",
        "HOTEL RAHMATH PRIVATE LIM KOZHIKODE IN", "9", "483.00", "DB"],
    ["18/03/2023", "7316413950",
        "POPEES BABY CARE PRODUC MALAPPURAM IN", "13", "699.00", "DB"],
    ["18/03/2023", "7316504478", "RELIANCE RETAIL LTD KOZHIKODE IN", "62", "311.61", "DB"],
    ["18/03/2023", "7317296456", "DSI KOZHIKODE CALICUT IN", "25", "1257.00", "DB"],
    ["23/03/2023", "7337264233", "AMAZON PAY INDIA PRIVATE WWW.AMAZON.IN IN",
        "359", "17976.00", "DB"],
    ["24/03/2023", "7339848134",
        "Interest Amount Amortization - <3/12>", "0", "984.25", "DB"],
    ["24/03/2023", "7339848138", "IGST-CI@18%", "0", "177.17", "DB"],
    ["24/03/2023", "7339848146",
        "Principal Amount Amortization - <3/12>", "0", "6954.29", "DB"],
    ["05/04/2023", "7383994155",
        "INFINITY PAYMENT RECEIVED, THANK YOU", "0", "28842.32", "CR"],
    ["04/04/2023", "7385236956", "MALABAR MASALA KOZHIKODE IN", "4", "220.00", "DB"],
    ["08/04/2023", "7399966364", "QESSAH BOUTIQUE KOZHIKODE IN", "60", "3000.00", "DB"],
    ["08/04/2023", "7404287921", "MANDI MALAPPURAM IN", "7", "370.00", "DB"],
    ["09/04/2023", "7404431685", "RELIANCE RETAIL LTD KOZHIKODE IN", "93", "465.83", "DB"],


    ["13/04/2023", "7416036113",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "4055.83", "CR"],
    ["12/04/2023", "7417187932",
        "SAVOURY SEASHELL RESTAURA KOZHIKODE IN", "10", "525.00", "DB"],
    ["13/04/2023", "7425889080", "AMAZON WEB SERVICES MUMBAI IN", "0", "9.88", "DB"],
    ["15/04/2023", "7426472245",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "534.88", "CR"],
    ["17/04/2023", "7437458718", "NESTO HYPERMARKET CALICUT IN", "154", "773.94", "DB"],
    ["20/04/2023", "7444556962",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "773.94", "CR"],
    ["20/04/2023", "7450893856", "GOOGLE CLOUD MUMBAI IN", "0", "2.00", "DB"],
    ["21/04/2023", "7454996330", "NESTO HYPERMARKET CALICUT IN", "148", "740.80", "DB"],
    ["22/04/2023", "7456921261",
        "REL RETAIL LTD-SMART MALAPPURAM IN", "141", "706.71", "DB"],
    ["24/04/2023", "7460701190",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "1449.51", "CR"],
    ["23/04/2023", "7461708928",
        "REL RETAIL LTD-SMART MALAPPURAM IN", "54", "272.25", "DB"],
    ["24/04/2023", "7463573420",
        "Interest Amount Amortization - <4/12>", "0", "891.58", "DB"],
    ["24/04/2023", "7463573424", "IGST-CI@18%", "0", "160.48", "DB"],
    ["24/04/2023", "7463573435",
        "Principal Amount Amortization - <4/12>", "0", "7046.96", "DB"],
    ["26/04/2023", "7469106094", "UPI Payment Received", "0", "4055.83", "CR"],
    ["26/04/2023", "7469125923", "NEFT PAYMENT RECEIVED", "0", "1.00", "CR"],
    ["16/05/2023", "7552020963",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "256.61", "CR"],
    ["24/05/2023", "7586798262",
        "Interest Amount Amortization - <5/12>", "0", "797.68", "DB"],
    ["24/05/2023", "7586798267", "IGST-CI@18%", "0", "143.58", "DB"],
    ["24/05/2023", "7586798279",
        "Principal Amount Amortization - <5/12>", "0", "140.86", "DB"],
    ["28/05/2023", "7599546741",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8082.12", "CR"],
    ["28/05/2023", "7599546854",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "256.61", "CR"],
    ["04/06/2023", "7633813285",
        "ZUDIO A UNIT OF TRENT KOZHIKODE IN", "61", "309.00", "DB"],
    ["08/06/2023", "7644141008",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "52.39", "CR"],
    ["11/06/2023", "7662349943", "NESTO HYPERMARKET CALICUT IN", "371", "1858.14", "DB"],
    ["18/06/2023", "7690426570", "NESTO HYPERMARKET CALICUT IN", "197", "989.88", "DB"],
    ["20/06/2023", "7692875821",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "2848.02", "CR"],
    ["24/06/2023", "7714644758",
        "Interest Amount Amortization - <6/12>", "0", "702.53", "DB"],
    ["25/06/2023", "7714644761", "IGST-CI@18%", "0", "126.46", "DB"],
    ["24/06/2023", "7714644770",
        "Principal Amount Amortization - <6/12>", "0", "7236.01", "DB"],
    ["28/06/2023", "7725240384",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8065.00", "CR"],
    ["28/06/2023", "7730778429", "AMAZON WEB SERVICES MUMBAI IN", "0", "2.00", "CR"],
    ["28/06/2023", "7731068480", "AMAZON WEB SERVICES MUMBAI IN", "0", "2.00", "DB"],
    ["05/07/2023", "7761313913", "ICAI CPABI NOIDA IN", "8", "400.00", "DB"],
    ["09/07/2023", "7775776292", "NESTO HYPERMARKET CALICUT IN", "282", "1411.40", "DB"],
    ["12/07/2023", "7782617583",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "1811.40", "CR"],
    ["20/07/2023", "7818719208",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "100.00", "CR"],
    ["24/07/2023", "7837559199",
        "Interest Amount Amortization - <7/12>", "0", "606.11", "DB"],
    ["24/07/2023", "7837559204", "IGST-CI@18%", "0", "109.10", "DB"],
    ["24/07/2023", "7837559213",
        "Principal Amount Amortization - <7/12>", "0", "7332.43", "DB"],
    ["25/07/2023", "7842592140", "HILITE HORECA LLP KOZHIKODE IN", "5", "255.00", "DB"],
    ["25/07/2023", "7843510556", "HAMEED BEEF RIBS HBR KOZHIKODE IN", "3", "184.00", "DB"],
    ["25/07/2023", "7843642717", "MARUTI INSURANCE NAT KOLKATTA IN",
        "208", "10438.00", "DB"],
    ["25/07/2023", "7844005476", "NESTO HYPERMARKET CALICUT IN", "73", "368.90", "DB"],
    ["31/07/2023", "7860193265",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "100.00", "CR"],
    ["25/08/2023", "7969259918",
        "Reward redemption handling fee-Ord.No.CP000770063 dtd 280723", "0", "99.00", "DB"],
    ["25/08/2023", "7969259922", "IGST-CI@18%", "0", "17.82", "DB"],
    ["24/08/2023", "7965813388",
        "Interest Amount Amortization - <8/12>", "0", "508.40", "DB"],
    ["24/08/2023", "7965813390", "IGST-CI@18%", "0", "91.51", "DB"],
    ["24/08/2023", "7965813402",
        "Principal Amount Amortization - <8/12>", "0", "7430.14", "DB"],
    ["16/08/2023", "7936639360",
        "Flipkart Internet PVT LTD BANGALORE IN", "32", "1638.00", "DB"],
    ["27/08/2023", "7973537340",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "19093.54", "CR"],
    ["30/08/2023", "7995513972", "PAYTM NOIDA IN", "101", "506.00", "DB"],
    ["31/08/2023", "8001578508",
        "AMAZON PAY INDIA PRIVATET BANGALORE IN", "23", "1199.00", "DB"],
    ["01/09/2023", "8001474147",
        "Flipkart Internet PVT LTD BANGALORE IN", "-18", "939.00", "CR"],
    ["08/09/2023", "8024192370",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "8410.00", "CR"],
    ["08/09/2023", "8029916959", "CHICKING MANSOR ERNAKULAM IN", "11", "571.20", "DB"],
    ["07/09/2023", "8030506864",
        "Flipkart Internet PVT LTD BANGALORE IN", "14", "748.00", "DB"],
    ["24/09/2023", "8092543702",
        "Interest Amount Amortization - <9/12>", "0", "409.40", "DB"],
    ["24/09/2023", "8092543705", "IGST-CI@18%", "0", "73.69", "DB"],
    ["24/09/2023", "8092543718",
        "Principal Amount Amortization - <9/12>", "0", "7529.14", "DB"],
    ["14/09/2023", "8055652445", "CHICKING MANSOR ERNAKULAM IN", "11", "571.20", "DB"],
    ["15/09/2023", "8058832093",
        "RAZ*RELIANCE RETAIL LI HTTPS://WWW.JIN", "36", "181.00", "DB"],
    ["23/09/2023", "8087402248",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "3460.07", "CR"],
    ["24/09/2023", "8095134084", "KFWFB Gurgaon IN", "40", "2000.00", "DB"],
    ["27/09/2023", "8101209150",
        "INFINITY PAYMENT RECEIVED THANK YOU", "0", "3460.07", "CR"],
    ["28/09/2023", "8110914569",
        "Flipkart Internet PVT LTD Bangalore IN", "-9", "499.00", "CR"],
    ["07/10/2023", "8148992689", "PALAKKAL FUELS WAYANAD IN", "0", "1097.80", "DB"],
    ["07/10/2023", "8149263340",
        "MSW*EN URU CHARITABLE S Wayanad IN", "8", "400.00", "DB"],
    ["07/10/2023", "8150553512",
        "WHITEHOUSE RESTAURANT KOZHIKODE IN", "16", "831.00", "DB"],
    ["08/10/2023", "8154976352", "PAZHERI GOLD PALAKKAD IN", "130", "6500.00", "DB"],
    ["09/11/2023", "8307626525", "Cashback@ HPCL Fuel Purchases", "0", "21.83", "CR"],
    ["10/11/2023", "8312898909", "Annual Fee reversal for 1st yr", "0", "500.00", "CR"],
    ["10/11/2023", "8312898913", "IGST-Rev-BI@18%", "0", "90.00", "CR"],
    ["22/10/2023", "8229351387", "UPI Payment Received", "0", "16808.86", "CR"],
    ["24/10/2023", "8237314506",
        "Interest Amount Amortization - <10/12>", "0", "309.07", "DB"],
    ["24/10/2023", "8237314507", "IGST-CI@18%", "0", "55.63", "DB"],
    ["24/10/2023", "8237314521",
        "Principal Amount Amortization - <10/12>", "0", "7629.47", "DB"],
    ["13/10/2023", "8185809646", "NOBLE PETROLUEM KOZHIKODE IN", "0", "545.71", "DB"],
    ["15/10/2023", "8187029621",
        "Super saver - Offus - Fuel surcharge REV", "0", "10.00", "CR"],
    ["14/10/2023", "8190196939",
        "HILITE FOOD AND BEVERAG Calicut IN", "38", "190.00", "DB"],
    ["14/10/2023", "8190629058", "NESTO HYPERMARKET CALICUT IN", "504", "2524.40", "DB"],
    ["14/10/2023", "8195777432",
        "Flipkart Internet PVT LTD Bangalore IN", "14", "724.00", "DB"],
    ["14/10/2023", "8195787526",
        "Flipkart Internet PVT LTD Bangalore IN", "21", "1051.00", "DB"],
    ["14/10/2023", "8195824320",
        "AMAZON PAY INDIA PRIVATET Bangalore IN", "33", "1676.00", "DB"],
    ["21/10/2023", "8232783768",
        "Flipkart Internet PVT LTD Bangalore IN", "7", "399.00", "DB"],
    ["23/10/2023", "8240355997",
        "AMAZON PAY INDIA PRIVATET Bangalore IN", "-11", "599.00", "CR"],
    ["25/10/2023", "8243819688",
        "MSW*PILAKKANDI ABDUL GA Wayanad IN", "32", "1643.00", "DB"],
    ["25/10/2023", "8243824697", "COCO MANJERI MANJERI BAZAR IN", "0", "1644.89", "DB"],
    ["25/10/2023", "8244544558",
        "WHITEHOUSE RESTAURANT KOZHIKODE IN", "12", "600.00", "DB"],
    ["26/10/2023", "8245328913",
        "Super saver - Offus - Fuel surcharge REV", "0", "16.45", "CR"],
    ["26/10/2023", "8248337210",
        "WHITEHOUSE RESTAURANT KOZHIKODE IN", "104", "5248.00", "DB"],
    ["26/10/2023", "8251086118",
        "KODUVALLY S C CO SOC KOZHIKODE IN", "0", "1641.14", "DB"],
    ["29/10/2023", "8261523913", "PALAZHI PETROLEUM CALICUT IN", "0", "544.74", "DB"],
    ["30/10/2023", "8262405079",
        "Super saver - Offus - Fuel surcharge REV", "0", "10.00", "CR"],
    ["01/11/2023", "8267982360", "NEFT PAYMENT RECEIVED", "0", "1.00", "CR"],
    ["31/10/2023", "8270788154",
        "Flipkart Internet PVT LTD Bangalore IN", "-7", "388.00", "CR"],
    ["31/10/2023", "8270843958",
        "Flipkart Internet PVT LTD Bangalore IN", "-7", "399.00", "CR"],
    ["02/11/2023", "8279879337", "ARABIAN PALACE KOZHIKODE IN", "11", "550.00", "DB"],
    ["02/11/2023", "8280535376",
        "Godaddy India Domains an Gurgaon IN", "21", "1078.02", "DB"],
    ["08/11/2023", "8312127983", "CHICKING KOZHIKODE IN", "60", "3019.00", "DB"],
    ["23/10/2023", "8230041594", "NEFT PAYMENT RECEIVED", "0", "1.00", "CR"],
]

transaction_json_list = []
obj = []
data_list = []
try:
    count = 1
    for transaction in transaction_list:
        print("count: ", count, " len: ", len(transaction))

        data_list = transaction

        obj = {
            "id": count,
            "date": data_list[0],
            "transaction_id": data_list[1],
            "transaction_description": data_list[2],
            "transaction_point": data_list[3],
            "transaction_amount": data_list[4],
            "transaction_type": data_list[5],
        }
        transaction_json_list.append(obj)
        count += 1

    # print(transaction_json_list)
    import json
    # print(json.dumps(transaction_json_list))

    # Generate Json file with intent 4 spaces
    with open('transaction.json', 'w') as outfile:
        json.dump(transaction_json_list, outfile, indent=4)

except Exception as e:
    # print line number of error
    print("Error  ", e)
    print("Error on line {}".format(sys.exc_info()[-1].tb_lineno))
    print("Excepction :", count)
    print("data_list ", data_list)
    print("obj ", obj)
